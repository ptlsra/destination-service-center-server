$(document).ready(function(){
	





    var getUrlParameter = function getUrlParameter(sParam) {
	    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
	        sURLVariables = sPageURL.split('&'),
	        sParameterName,
	        i;

	    for (i = 0; i < sURLVariables.length; i++) {
	        sParameterName = sURLVariables[i].split('=');

	        if (sParameterName[0] === sParam) {
	            return sParameterName[1] === undefined ? true : sParameterName[1];
	        }
	    }
	};

	var pickupId = getUrlParameter('pickupId');
	var currentStatus = getUrlParameter('pickupStatus');



    function displayTxData(){
    


            if(currentStatus=="created"){
                
            alert("yes")
                // first transaction
               //second transaction -- hasn't been executed at this stage


                $('#txDisplayContainer').append( `
               
                <img src="assets/img/tick2.png"  class="b imageprop">  <span class="marginfortxData">Asset Created By consigner</span></img>
                 <div class="vl">
                 <span  id="assetCreated" class="fontsizecustom margintime"> </span>
                 <span  id="txId" class="fontsizecustom margintx"> </span>
                 </div>
                <img src="assets/img/circle.png"  class="b imageprop"> <span class="marginfortxData">BOL generated by SC1 admin </span></img>
                <div class="vs">
                <span  id="bolGenerated" class="fontsizecustom margintime"> </span>
                <span  id="txId2" class="fontsizecustom margintx"> </span>
                </div>
              <div class="container">

              <form id="generatebolform"  onsubmit="return generateBOL()" action="" method="post">

              <table class="table table-bordered marginleftcustom">
                <tr>
                  <td>Pickup ID</td>
                  <td id="pickupIdforForm" class="fontclassbold"></td>
                  <td>Assigned Service Center</td>
                  <td id="assignedServiceCenterForForm" class="fontclassbold"></td>
                  </tr>

               
               

                  <tr>
                  <td>Consignee's Name</td>
                  <td id="consigneeNameForForm" class="fontclassbold"></td>
                
                  <td>Consignee Email</td>
                  <td id="consigneeEmailForForm" class="fontclassbold"></td>
                  </tr>

                  <tr>
                  <td>Pickup Window</td>
                  <td id="pickupWindowForForm" class="fontclassbold"></td>
                
                  <td>Delivery Window</td>
                  <td id="deliveryWindowForForm" class="fontclassbold"></td>
                  </tr>

                  

                  <tr>
                  <td >Status</td>
                  <td id="pickupStatusForForm" class="fontclassbold"></td>

                  <td >Assign Driver For Pickup</td>
                  <td><select id="assignCityDriverForPickup" class="fullwidth">

                  
                  </select>
                  </td>
                  <td id="customerIdforForm" class="fullwidth"></td>

                  </tr>
                
                </table>

                <input type="submit" value="Generate BOL" class="btn adminBtn marginleftcustom" name="submitButton">
                </form>
              </div>



              
              <img src="assets/img/circle.png"  class="b imageprop">  <span class="marginfortxData">Confirm Pickup By Driver </span></img>
              <div class="vs">
               <span  id="confirmPickupByDriver" class="fontsizecustom margintime"> </span>
             
           <span  id="txId5" class="fontsizecustom margintx"> </span>
              </div>

               
          <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">  <span class="marginfortxData">Update Pickup Status by Driver </span></img>
          <div class="vs">
                 
              <span  id="customerSignaturePending" class="fontsizecustom margintime"> </span>
         
              <span  id="txId6" class="fontsizecustom margintx"> </span>
          </div> 


          <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow "> <span class="marginfortxData">Confirm Arrival at Source Service Center </span></img>
              <div class="vs animated slideInUp slower">
                     
                  <span  id="confirmArrivalofPickup" class="fontsizecustom margintime"> </span>
             
                  <span  id="txId7" class="fontsizecustom margintx"> </span>
              </div> 
              `);


              
            }

            if(currentStatus=="Generated_BOL"){

     
               


                $('#txDisplayContainer').append( `
               
                <img src="assets/img/tick2.png"  class="b imageprop"><span>Asset Created By consigner</span></img>
                 <div class="vl">
                 <span  id="assetCreated" class="fontsizecustom margintime"> </span>
                 <span  id="txId" class="fontsizecustom margintx"> </span>
                 </div>
                <img src="assets/img/tick2.png"  class="b imageprop">BOL generated by SC1 admin</img>
                <div class="vl">
                <span  id="bolGenerated" class="fontsizecustom margintime"> </span>
                <span  id="txId2" class="fontsizecustom margintx"> </span>
                </div>
              

              
                <img src="assets/img/circle.png"  class="b imageprop">Confirm Pickup By Driver</img>
                <div class="vs">
                 <span  id="confirmPickupByDriver" class="fontsizecustom margintime"> </span>
               
             <span  id="txId5" class="fontsizecustom margintx"> </span>
                </div>

              <div class="container">
              <form id="generatebolform"  onsubmit="return updatePickupStatusByCityDriver()" action="" method="post">

              <table class="table table-bordered marginleftcustom">
              
                <tr>
                  <td>Pickup ID</td>
                  <td id="pickupIdforForm" class="fontclassbold"></td>
                  <td>Service Center</td>
                  <td id="assignedServiceCenterForForm" class="fontclassbold"></td>
               
                  <td>Consignor's Name</td>
                  <td id="consignorsNameForForm" class="fontclassbold"></td>
                
                  <td>Consignor Email</td>
                  <td id="consignorsEmailForForm" class="fontclassbold"></td>
                  </tr>

                  <tr>
                  <td >Pickup Window</td>
                  <td id="pickupWindowForForm" class="fontclassbold" colspan="2"></td>
                
                  <td>Pickup Address</td>
                  <td id="pickupAddress" class="fontclassbold" colspan="2"></td>

                  <td>Consignor's PhoneNo</td>
                  <td id="consignorPhoneNo" class="fontclassbold"></td>
                 
                  </tr>
                  <tr>
                  <td >BOL ID</td>
                  <td  id="bolId" class="fontclassbold" colspan="3"></td>
                  <td >Status</td>
                  <td  id="pickupStatusForForm" class="fontclassbold" colspan="3"> BOL Generated.Confirm Pickup of Order</td>
                  <select id="assignCityDriverForPickup" class="fullwidth">

                  
                  </select></td>
                  <td id="customerIdforForm" class="fullwidth"></td>
                  </tr>
                 
               <tr>
               <td >Driver Assigned for Pickup</td>
               <td class="fontclassbold">yes</td>
               <td >Driver ID</td>
               <td class="fontclassbold" id="cityDriverId"></td>
              
               <td >Driver Name</td>
               <td class="fontclassbold" id="cityDriverName"></td>
               <td >Driver Email</td>
               <td class="fontclassbold" id="cityDriverEmail"></td>
               </tr>

               <tr>
               <td>Arrival time</td>
               <td><input type="text" id="pickupArrivalTime" name="pickupArrivalTime" placeholder="Enter arrival time"></td>

               <td>Departure time</td>
               <td><input type="text" id="pickupDepartureTime" name="pickupDepartureTime" placeholder="Enter Departure time"></td>
              

               <td>Weight of Pickup</td>
               <td><input type="text" id="weightOfPickup" name="weightOfPickup" placeholder="Enter Weight of Pikcup"></td>
             
               <td>Piece Count</td>
               <td><input type="number" id="pieceCount" name="pieceCount" placeholder="Enter Piece Count"></td>
              
               </tr>

               <tr>
               <td>Handling Unit</td>
               <td><input type="text" id="handlingUnit" name="handlingUnit" placeholder="Enter Handling Unit "></td>

               <td>Package Type</td>
               <td><input type="text" id="pkgType" name="pkgType" placeholder="Enter Package Type"></td>
              

               <td>Package Description</td>
               <td><input type="text" id="packageDescription" name="packageDescription" placeholder="Enter Weight of Pikcup"></td>
             
               <td>NMFC Item No</td>
               <td><input type="number" id="nmfcItemNo" name="nmfcItemNo" placeholder="Enter Item No"></td>
              
               </tr>
            


               <tr>
               <td>Freight Amount</td>
               <td><input type="number" id="freightAmount" name="freightAmount" placeholder="Enter freight Amount "></td>

               <td>Freight Terms</td>
               <td><input type="text" id="freightTerms" name="freightTerms" placeholder="eg: Prepaid"></td>
              

               <td >Freight Description</td>
               <td colspan="3"><input type="text" class="fullwidth" id="freightDescription" name="freightDescription" placeholder="Enter Freight Description"></td>
             
              </tr>
              
              
               <tr>
               <td colspan="4">Upload Image</td>
              <td colspan="4"> <input type="file" id="uploadPickupImage"/></td>
               </tr>

               </table>
               <input type="submit" value="Confirm Pickup" class="btn adminBtn marginleftcustom" name="submitButton">
               </form>
              </div>

             
              
            

               
          <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">Update Pickup Status by Driver</img>
          <div class="vs">
                 
              <span  id="customerSignaturePending" class="fontsizecustom margintime"> </span>
         
              <span  id="txId6" class="fontsizecustom margintx"> </span>
          </div> 


          <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">Confirm Arrival at Source Service Center</img>
              <div class="vs animated slideInUp slower">
                     
                  <span  id="confirmArrivalofPickup" class="fontsizecustom margintime"> </span>
             
                  <span  id="txId7" class="fontsizecustom margintx"> </span>
              </div> 
              `);
               
             

            }

            
            if(currentStatus=="Pickup_Confirmed_By_City_Driver"){
            





                $('#txDisplayContainer').append( `
               
                <img src="assets/img/tick2.png"  class="b imageprop"><span>Asset Created By consigner</span></img>
                 <div class="vl">
                 <span  id="assetCreated" class="fontsizecustom margintime"> </span>
                 <span  id="txId" class="fontsizecustom margintx"> </span>
                 </div>
                <img src="assets/img/tick2.png"  class="b imageprop">BOL generated by SC1 admin</img>
                <div class="vl">
                <span  id="bolGenerated" class="fontsizecustom margintime"> </span>
                <span  id="txId2" class="fontsizecustom margintx"> </span>
                </div>
              

              
                <img src="assets/img/tick2.png"  class="b imageprop">Confirm Pickup By Driver</img>
                <div class="vl">
                 <span  id="confirmPickupByDriver" class="fontsizecustom margintime"> </span>
               
             <span  id="txId5" class="fontsizecustom margintx"> </span>
                </div>

                <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">Customer Signature Pending</img>
                <div class="vs">
                       
                    <span  id="customerSignaturePending" class="fontsizecustom margintime"> </span>
               
                    <span  id="txId6" class="fontsizecustom margintx"> </span>
                </div> 

              <div class="container">
              <form id="generatebolform"  onsubmit="return updatePickupStatusByCityDriver()" action="" method="post">

              <table class="table table-bordered marginleftcustom">
              <tr>
              <td>Pickup ID</td>
              <td id="pickupIdforForm" class="fontclassbold"></td>
              <td>Service Center</td>
              <td id="assignedServiceCenterForForm" class="fontclassbold"></td>
           
              <td>Consignor's Name</td>
              <td id="consignorsNameForForm" class="fontclassbold"></td>
            
              <td>Consignor Email</td>
              <td id="consignorsEmailForForm" class="fontclassbold"></td>
              </tr>

              <tr>
              <td >Pickup Window</td>
              <td id="pickupWindowForForm" class="fontclassbold" colspan="2"></td>
            
              <td>Pickup Address</td>
              <td id="pickupAddress" class="fontclassbold" colspan="2"></td>

              <td>Consignor's PhoneNo</td>
              <td id="consignorPhoneNo" class="fontclassbold"></td>
             
              </tr>
              <tr>
                 
                  <td >BOL ID</td>
                  <td  id="bolId" class="fontclassbold"></td>
                  <td >Image</td>
                  <td  id="uploadPickupImage" class="fontclassbold"></td>
                  <td >Status</td>
                  <td  id="pickupStatusForForm" class="fontclassbold" colspan="3"> Order Picked Up.Waiting for consignors's signature</td>
                  <select id="assignCityDriverForPickup" class="fullwidth">

                  
                  </select></td>
                  <td id="customerIdforForm" class="fullwidth"></td>
                  </tr>
                 
               <tr>
               <td >Driver Assigned </td>
               <td class="fontclassbold">yes</td>
               <td >Driver ID</td>
               <td class="fontclassbold" id="cityDriverId"></td>
              
               <td >Driver Name</td>
               <td class="fontclassbold" id="cityDriverName"></td>
               <td >Driver Email</td>
               <td class="fontclassbold" id="cityDriverEmail"></td>
               </tr>

               <tr>
               <td>Arrival time</td>
               <td><input type="text" id="pickupArrivalTime" name="pickupArrivalTime" readonly></td>

               <td>Departure time</td>
               <td><input type="text" id="pickupDepartureTime" name="pickupDepartureTime" readonly></td>
              

               <td>Weight of Pickup</td>
               <td><input type="text" id="weightOfPickup" name="weightOfPickup" readonly></td>
             
               <td>Piece Count</td>
               <td><input type="number" id="pieceCount" name="pieceCount" readonly></td>
              
               </tr>

               <tr>
               <td>Handling Unit</td>
               <td><input type="text" id="handlingUnit" name="handlingUnit" readonly></td>

               <td>Package Type</td>
               <td><input type="text" id="pkgType" name="pkgType" readonly></td>
              

               <td>Package Description</td>
               <td><input type="text" id="packageDescription" name="packageDescription" readonly></td>
             
               <td>NMFC Item No</td>
               <td><input type="number" id="nmfcItemNo" name="nmfcItemNo" readonly></td>
              
               </tr>
               <tr>
               <td>Freight Amount</td>
               <td><input type="number" id="freightAmount" name="freightAmount" readonly></td>

               <td>Freight Terms</td>
               <td><input type="text" id="freightTerms" name="freightTerms" readonly></td>
              

               <td >Freight Description</td>
               <td colspan="3"><input type="text" class="fullwidth" id="freightDescription" name="freightDescription" readonly></td>
             
              
              
               </tr>



               </table>
               </form>
              </div>

             
              
            

               
        


          <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">Confirm Arrival at Source Service Center</img>
              <div class="vs animated slideInUp slower">
                     
                  <span  id="confirmArrivalofPickup" class="fontsizecustom margintime"> </span>
             
                  <span  id="txId7" class="fontsizecustom margintx"> </span>
              </div> 
              `);
            
            }



            if(currentStatus=="Customer_Sign_Received"){
            





                $('#txDisplayContainer').append( `
               
                <img src="assets/img/tick2.png"  class="b imageprop"><span>Asset Created By consigner</span></img>
                 <div class="vl">
                 <span  id="assetCreated" class="fontsizecustom margintime"> </span>
                 <span  id="txId" class="fontsizecustom margintx"> </span>
                 </div>
                <img src="assets/img/tick2.png"  class="b imageprop">BOL generated by SC1 admin</img>
                <div class="vl">
                <span  id="bolGenerated" class="fontsizecustom margintime"> </span>
                <span  id="txId2" class="fontsizecustom margintx"> </span>
                </div>
              

              
                <img src="assets/img/tick2.png"  class="b imageprop">Confirm Pickup By Driver</img>
                <div class="vl">
                 <span  id="confirmPickupByDriver" class="fontsizecustom margintime"> </span>
               
             <span  id="txId5" class="fontsizecustom margintx"> </span>
                </div>

                <img src="assets/img/tick2.png"class="b imageprop  animated fadeIn slow ">Customer Signature Pending</img>
                <div class="vl">
                       
                    <span  id="customerSignaturePending" class="fontsizecustom margintime"> </span>
               
                    <span  id="txId6" class="fontsizecustom margintx"> </span>
                </div> 
                <img src="assets/img/circle.png"class="b imageprop  animated fadeIn slow ">Confirm Arrival at Source Service Center</img>
                <div class="vs animated slideInUp slower">
                       
                    <span  id="confirmArrivalofPickup" class="fontsizecustom margintime"> </span>
               
                    <span  id="txId7" class="fontsizecustom margintx"> </span>
                </div> 
              <div class="container">
              <form id="generatebolform"  onsubmit="return updatePickupStatusByCityDriver()" action="" method="post">

              <table class="table table-bordered marginleftcustom">
              <tr>
              <td>Pickup ID</td>
              <td id="pickupIdforForm" class="fontclassbold"></td>
              <td>Service Center</td>
              <td id="assignedServiceCenterForForm" class="fontclassbold"></td>
           
              <td>Consignor's Name</td>
              <td id="consignorsNameForForm" class="fontclassbold"></td>
            
              <td>Consignor Email</td>
              <td id="consignorsEmailForForm" class="fontclassbold"></td>
              </tr>

              <tr>
              <td >Pickup Window</td>
              <td id="pickupWindowForForm" class="fontclassbold" colspan="2"></td>
            
              <td>Pickup Address</td>
              <td id="pickupAddress" class="fontclassbold" colspan="2"></td>

              <td>Consignor's PhoneNo</td>
              <td id="consignorPhoneNo" class="fontclassbold"></td>
             
              </tr>
              <tr>
                 
              <td >BOL ID</td>
              <td  id="bolId" class="fontclassbold"></td>
              <td >Image</td>
              <td  id="uploadPickupImage" class="fontclassbold"></td>
              <td >Status</td>
              <td  id="pickupStatusForForm" class="fontclassbold" colspan="3"> Order Picked Up.Waiting for consignors's signature</td>
              <select id="assignCityDriverForPickup" class="fullwidth">

              
              </select></td>
              <td id="customerIdforForm" class="fullwidth"></td>
              </tr>
             
           <tr>
                 
               <tr>
               <td >Driver Assigned </td>
               <td class="fontclassbold">yes</td>
               <td >Driver ID</td>
               <td class="fontclassbold" id="cityDriverId"></td>
              
               <td >Driver Name</td>
               <td class="fontclassbold" id="cityDriverName"></td>
               <td >Driver Email</td>
               <td class="fontclassbold" id="cityDriverEmail"></td>
               </tr>

               <tr>
               <td>Arrival time</td>
               <td><input type="text" id="pickupArrivalTime" name="pickupArrivalTime" readonly></td>

               <td>Departure time</td>
               <td><input type="text" id="pickupDepartureTime" name="pickupDepartureTime" readonly></td>
              

               <td>Weight of Pickup</td>
               <td><input type="text" id="weightOfPickup" name="weightOfPickup" readonly></td>
             
               <td>Piece Count</td>
               <td><input type="number" id="pieceCount" name="pieceCount" readonly></td>
              
               </tr>

               <tr>
               <td>Handling Unit</td>
               <td><input type="text" id="handlingUnit" name="handlingUnit" readonly></td>

               <td>Package Type</td>
               <td><input type="text" id="pkgType" name="pkgType" readonly></td>
              

               <td>Package Description</td>
               <td><input type="text" id="packageDescription" name="packageDescription" readonly></td>
             
               <td>NMFC Item No</td>
               <td><input type="number" id="nmfcItemNo" name="nmfcItemNo" readonly></td>
              
               </tr>

               

               <tr>
               <td>Freight Amount</td>
               <td><input type="number" id="freightAmount" name="freightAmount" readonly></td>

               <td>Freight Terms</td>
               <td><input type="text" id="freightTerms" name="freightTerms" readonly></td>
              

               <td >Freight Description</td>
               <td ><input type="text" class="fullwidth" id="freightDescription" name="freightDescription" readonly></td>
             
               <td >Consigner's Approval Recieved</td>
               <td  id="shipperSignature" class="fontclassbold"></td>
              
               </tr>

               </table>
               </form>
              </div>

             
              
            

               
        


        
              `);
            
            }



            if( (currentStatus=="Pickup_at_Source_Service_Centre" ) || (currentStatus=="shipmentCreated")){
            





                $('#txDisplayContainer').append( `
               
                <img src="assets/img/tick2.png"  class="b imageprop"><span>Asset Created By consigner</span></img>
                 <div class="vl">
                 <span  id="assetCreated" class="fontsizecustom margintime"> </span>
                 <span  id="txId" class="fontsizecustom margintx"> </span>
                 </div>
                <img src="assets/img/tick2.png"  class="b imageprop">BOL generated by SC1 admin</img>
                <div class="vl">
                <span  id="bolGenerated" class="fontsizecustom margintime"> </span>
                <span  id="txId2" class="fontsizecustom margintx"> </span>
                </div>
              

              
                <img src="assets/img/tick2.png"  class="b imageprop">Confirm Pickup By Driver</img>
                <div class="vl">
                 <span  id="confirmPickupByDriver" class="fontsizecustom margintime"> </span>
               
             <span  id="txId5" class="fontsizecustom margintx"> </span>
                </div>

                <img src="assets/img/tick2.png"class="b imageprop  animated fadeIn slow ">Customer Signature Pending</img>
                <div class="vl">
                       
                    <span  id="customerSignaturePending" class="fontsizecustom margintime"> </span>
               
                    <span  id="txId6" class="fontsizecustom margintx"> </span>
                </div> 
                <img src="assets/img/tick2.png" class="b imageprop  animated fadeIn slow ">Confirm Arrival at Source Service Center</img>
                <div class="vl animated slideInUp slower">
                       
                    <span  id="confirmArrivalofPickup" class="fontsizecustom margintime"> </span>
               
                    <span  id="txId7" class="fontsizecustom margintx"> </span>
                </div> 
              <div class="container">
              <form id="generatebolform"  onsubmit="return updatePickupStatusByCityDriver()" action="" method="post">

              <table class="table table-bordered marginleftcustom">
              <tr>
              <td>Pickup ID</td>
              <td id="pickupIdforForm" class="fontclassbold"></td>
              <td>Service Center</td>
              <td id="assignedServiceCenterForForm" class="fontclassbold"></td>
           
              <td>Consignor's Name</td>
              <td id="consignorsNameForForm" class="fontclassbold"></td>
            
              <td>Consignor Email</td>
              <td id="consignorsEmailForForm" class="fontclassbold"></td>
              </tr>

              <tr>
              <td >Pickup Window</td>
              <td id="pickupWindowForForm" class="fontclassbold" colspan="2"></td>
            
              <td>Pickup Address</td>
              <td id="pickupAddress" class="fontclassbold" colspan="2"></td>

              <td>Consignor's PhoneNo</td>
              <td id="consignorPhoneNo" class="fontclassbold"></td>
             
              </tr>
              <tr>
                 
                  <td >BOL ID</td>
                  <td  id="bolId" class="fontclassbold" colspan="3"></td>
                  <td >Status</td>
                  <td  id="pickupStatusForForm" class="fontclassbold" colspan="3">Pickup at Source Service Center</td>
                  <select id="assignCityDriverForPickup" class="fullwidth">

                  
                  </select></td>
                  <td id="customerIdforForm" class="fullwidth"></td>
                  </tr>
                 
              
                 
                
                 
               <tr>
               <td >Driver Assigned </td>
               <td class="fontclassbold">yes</td>
               <td >Driver ID</td>
               <td class="fontclassbold" id="cityDriverId"></td>
              
               <td >Driver Name</td>
               <td class="fontclassbold" id="cityDriverName"></td>
               <td >Driver Email</td>
               <td class="fontclassbold" id="cityDriverEmail"></td>
               </tr>

               <tr>
               <td>Arrival time</td>
               <td><input type="text" id="pickupArrivalTime" name="pickupArrivalTime" readonly></td>

               <td>Departure time</td>
               <td><input type="text" id="pickupDepartureTime" name="pickupDepartureTime" readonly></td>
              

               <td>Weight of Pickup</td>
               <td><input type="text" id="weightOfPickup" name="weightOfPickup" readonly></td>
             
               <td>Piece Count</td>
               <td><input type="number" id="pieceCount" name="pieceCount" readonly></td>
              
               </tr>

               <tr>
               <td>Handling Unit</td>
               <td><input type="text" id="handlingUnit" name="handlingUnit" readonly></td>

               <td>Package Type</td>
               <td><input type="text" id="pkgType" name="pkgType" readonly></td>
              

               <td>Package Description</td>
               <td><input type="text" id="packageDescription" name="packageDescription" readonly></td>
             
               <td>NMFC Item No</td>
               <td><input type="number" id="nmfcItemNo" name="nmfcItemNo" readonly></td>
              
               </tr>

               <tr>
               <td>Freight Amount</td>
               <td><input type="number" id="freightAmount" name="freightAmount" readonly></td>

               <td>Freight Terms</td>
               <td><input type="text" id="freightTerms" name="freightTerms" readonly></td>
              

               <td >Freight Description</td>
               <td ><input type="text" class="fullwidth" id="freightDescription" name="freightDescription" readonly></td>
             
               <td >Consigner's Approval Recieved</td>
               <td  id="shipperSignature" class="fontclassbold"></td>
              
               </tr>

               </table>
               <br>
               </form>
              </div>

             
              
            

               
        


        
              `);
            
            }
				//alert(JSON.stringify(item));

				//item.timeStamp;
			
			//	var shipperName=item.value.shipperName;
             //   shipperName = shipperName.split("_").join(" ");

              //  var consigneeName=item.value.consigneeName;
              //  consigneeName = consigneeName.split("_").join(" ");
                

				//tempLists.push(index,'<a href=# data-toggle="tooltip" title='+item.txId+'>'+item.txId.substring(0,20)+'...',item.timestamp,shipperName,consigneeName,item.value.bolId,item.value.shipmentId,item.value.pickupStatus);
				
				//alert(dataSet);		               
			
	


    


    }



    function setHistory(){
        setTimeout(function(){
    
        $.get("/history/"+pickupId, function(response){
            // alert(JSON.stringify(response));
            var index = 1;
            $.each(response, function(i, item) {
    
    
                var status=item.value.pickupStatus;
                status = status.split("_").join(" ");
    
    
                if(status=="created"){
                    document.getElementById('assetCreated').innerHTML=' - Executed at '+item.timestamp;
                    document.getElementById('txId').innerHTML=' with txId: <button class="buttonLink" onclick=getTxDetails("'+item.txId+'")>'+item.txId+'</button>';
    
                }
                if(status=="Generated BOL"){
                    document.getElementById('bolGenerated').innerHTML=' - Executed at '+item.timestamp;
                    document.getElementById('txId2').innerHTML=' with txId: <button class="buttonLink" onclick=getTxDetails("'+item.txId+'")>'+item.txId+'</button>';
                    
                    var cityDriverId=item.value.cityDriverId;
                    //var cityDriverId="dri-100000000001"
                    getAssignedDriverDetails(cityDriverId)
                }

                if(status=="Pickup Confirmed By City Driver"){
                    document.getElementById('confirmPickupByDriver').innerHTML=' - Executed at '+item.timestamp;
                    document.getElementById('txId5').innerHTML=' with txId: <button class="buttonLink" onclick=getTxDetails("'+item.txId+'")>'+item.txId+'</button>';
                    
                    var cityDriverId=item.value.cityDriverId;
                    
                    var bolId=item.value.bolId;
                    //var cityDriverId="dri-100000000001"
                    getAssignedDriverDetails(cityDriverId)

                    getBOLDetails(bolId)

                    
                }

                if(status=="Customer Sign Received"){
                    document.getElementById('customerSignaturePending').innerHTML=' - Executed at '+item.timestamp;
                    document.getElementById('txId6').innerHTML=' with txId: <button class="buttonLink" onclick=getTxDetails("'+item.txId+'")>'+item.txId+'</button>';
                    
                    var cityDriverId=item.value.cityDriverId;
                    
                    var bolId=item.value.bolId;
                    getAssignedDriverDetails(cityDriverId)

                    getBOLDetails(bolId)
                   
                }

                if(status=="Pickup at Source Service Centre" || status=="shipmentCreated"){
                    document.getElementById('confirmArrivalofPickup').innerHTML=' - Executed at '+item.timestamp;
                    document.getElementById('txId7').innerHTML=' with txId: <button class="buttonLink" onclick=getTxDetails("'+item.txId+'")>'+item.txId+'</button>';
                    
                    var cityDriverId=item.value.cityDriverId;
                    
                    var bolId=item.value.bolId;
                    getAssignedDriverDetails(cityDriverId)

                    getBOLDetails(bolId)
                   
                }

                

                
            })
        })

    },5000)
    }


    function getAssignedDriverDetails(cityDriverId){
        $.get("/driver/"+cityDriverId, function(response){
         //   alert(JSON.stringify(response))
            document.getElementById('cityDriverId').innerHTML=response.driverId;
            document.getElementById('cityDriverName').innerHTML=response.firstName+' '+response.lastName;
            document.getElementById('cityDriverEmail').innerHTML=response.emailId;

    });
    }


    function getBOLDetails(bolId){
        $.get("/billoflading/"+bolId, function(response){
         //   alert(JSON.stringify(response))

       

         

             $('#pickupArrivalTime').val(response.pickupArrivalTime)
             $('#pickupDepartureTime').val(response.pickupDepartTime)
             $('#weightOfPickup').val(response.freightDetails[0].weight)
             $('#pieceCount').val(response.pieceCount)
             $('#handlingUnit').val(response.freightDetails[0].handlingUnit)
             $('#pkgType').val(response.freightDetails[0].pkgType)
             $('#packageDescription').val(response.freightDetails[0].packageDescription)
             $('#nmfcItemNo').val(response.freightDetails[0].nmfcItemNo)
             
             frieghtTerms=response.frieghtTerms;
             freightDescription=response.freightDescription;

             freightAmount=response.freightAmount;

             
             
             if(frieghtTerms){
                $('#freightAmount').val(freightAmount);

                $('#freightTerms').val(frieghtTerms);
        
                $('#freightDescription').val(freightDescription);
             }

             var shipperSignature=response.shipperSignature;

             if(shipperSignature=="true"){
                document.getElementById('shipperSignature').innerHTML=shipperSignature;
    
             }

    });
    }

    function setFormDetails(){
       
        

        $.get("/pickup/"+pickupId, function(response){

        //console.log(response)

        var shipperName=response.shipperName;
        shipperName = shipperName.split("_").join(" ");

        var consigneeName=response.consigneeName;
        consigneeName = consigneeName.split("_").join(" ");

        var pickupStatus=response.pickupStatus;
        pickupStatus = pickupStatus.split("_").join(" ");


        document.getElementById('pickupIdforForm').innerHTML=pickupId;
        document.getElementById('assignedServiceCenterForForm').innerHTML=response.serviceCenterId;
        document.getElementById('consignorsNameForForm').innerHTML=shipperName;
        document.getElementById('consignorsEmailForForm').innerHTML=response.shipperAddress;

        //document.getElementById('consigneeNameForForm').innerHTML=consigneeName;
        //document.getElementById('consigneeEmailForForm').innerHTML=response.consigneeAddress;
        document.getElementById('pickupWindowForForm').innerHTML=response.pickupWindow.from+' - '+response.pickupWindow.to;

        document.getElementById('pickupAddress').innerHTML=response.customerAddress;
        //document.getElementById('pickupStatusForForm').innerHTML=pickupStatus;
        document.getElementById('customerIdforForm').innerHTML=response.customerId;

        
        document.getElementById('consignorPhoneNo').innerHTML=response.customerPhoneNumber;

        document.getElementById('customerIdforForm').style.display='none';
        

        var bolId=response.bolId;
        var shipmentId=response.shipmentId;
        var imageData=response.image.imageData;

        if(bolId){
            $('#assignCityDriverForPickup').hide();
            document.getElementById('bolId').innerHTML=bolId;

           // bolGenerated
        }else{
            $('#assignCityDriverForPickup').append($('<option>', { 
                value: 'None',
                text : 'None' 
            }
            
            ));
    
          $.getJSON("/drivers/city", function(response){ //replace with city driver for service centre
    
               
           
         
    
        $.each(response, function (i, item) {
            $('#assignCityDriverForPickup').append($('<option>', { 
                value: item.record.driverId,
                text : item.record.firstName+' '+item.record.lastName 
            }
            
            ));
        });
    });

        }
        if(shipmentId){

        }
        if(imageData){
            document.getElementById('uploadPickupImage').innerHTML='<a data-toggle="modal" href="#setImageModal">View Image</a>'

document.getElementById('setImageData').innerHTML='<img src=\"'+imageData+'\"width=\"400px\" height=\"150px\">'
        }


         //assign city driver

        
      



        $.getJSON("/customers", function(response){

            $.each(response, function (i, item) {
                var customerId=localStorage.getItem("customerId");
                var customerIdFromResponse=item.record.customerId;
                if(customerId==customerIdFromResponse){
                
                }else{
                    $('#selectConsignee').append($('<option>', { 
                    value: item.record.customerId,
                    text : item.record.firstName+' '+item.record.lastName
                }
                
               
                
                ));
            }
            });
                });
                

           
                
         

        
    });

    }






    var displayDetails = function() {
     
      };
      
      displayDetails.prototype.callDisplayTxFunction = function() {
        displayTxData()
        this.name = 'displayTx';
        return this;
      };
      
      displayDetails.prototype.callSetPickupDetails = function() {
          setFormDetails()
        this.callFunction = 'setFormValues';
        return this;
      };
      
     
      displayDetails.prototype.callSetHistory = function() {
       
        setHistory()
       
      this.callFunction = 'setHistory';
      return this;
    };

    new displayDetails().callDisplayTxFunction().callSetPickupDetails().callSetHistory();
  

    
});



function getTxDetails(txId) {
    //alert(txId)
    
    document.getElementById('txDetailsModalTxId').innerHTML=txId;
    $('#txDetailsModal').modal();

    $.get("/transaction/"+txId, function(response){

    console.log(response.transactionEnvelope.payload.header.channel_header.timestamp)
    console.log(response.transactionEnvelope.payload.header.channel_header.channel_id)
    console.log(response.transactionEnvelope.payload.header.signature_header.creator.Mspid)
    console.log(response.transactionEnvelope.payload.data.actions[0].payload.action.proposal_response_payload.extension.results.ns_rwset[0].namespace)
    console.log(response.transactionEnvelope.payload.data.actions[0].payload.action.proposal_response_payload.extension.results.ns_rwset[0].rwset.reads)
    console.log(response.transactionEnvelope.payload.data.actions[0].payload.action.proposal_response_payload.extension.results.ns_rwset[0].rwset.writes)

    
    document.getElementById('txDetailsModalTimestamp').innerHTML=response.transactionEnvelope.payload.header.channel_header.timestamp;
    document.getElementById('txDetailsModalChannelId').innerHTML=response.transactionEnvelope.payload.header.channel_header.channel_id;
    document.getElementById('txDetailsModalExecutedBy').innerHTML=response.transactionEnvelope.payload.header.signature_header.creator.Mspid;

    

});
}



